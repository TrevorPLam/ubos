# C4 Model\n\n**Official**: https://c4model.com/  \n**Version**: 2.1  \n**Purpose**: Visualize software architecture at four levels  \n**When to Use**: Documenting system architecture and design\n\n---\n\n## ğŸ—ï¸ The Four Levels\n\n### Level 1: System Context\n**Shows**: Your system and its users/external systems  \n**Audience**: Everyone (business, technical, stakeholders)  \n**Abstraction**: Very high  \n**Scope**: External dependencies and user personas\n\n**Elements**:\n- Software System (your main system)\n- Users/Actors\n- External Systems\n- Interactions between them\n\n**Example - UBOS Context**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                                                 â”‚\nâ”‚  Customer  â”‚  UBOS Platform  â”‚  Payment Service â”‚\nâ”‚  (User)    â”‚  (CRM/Business  â”‚  (Stripe)        â”‚\nâ”‚            â”‚   Operations)   â”‚                  â”‚\nâ”‚            â”‚                 â”‚                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n### Level 2: Container\n**Shows**: Applications and data stores  \n**Audience**: Technical people, architects  \n**Abstraction**: Medium-high  \n**Scope**: Major architectural components\n\n**Elements**:\n- Web Applications\n- APIs\n- Microservices\n- Databases\n- Message Queues\n- External Services\n\n**Example - UBOS Containers**:\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚           UBOS Platform                     â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\nâ”‚  â”‚  React   â”‚  â”‚ Express  â”‚  â”‚Database  â”‚ â”‚\nâ”‚  â”‚  Client  â”‚  â”‚  API     â”‚  â”‚PostgreSQLâ”‚ â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**UBOS Containers**:\n- **React SPA**: Client application (browser)\n- **Express API**: Backend server (Node.js)\n- **PostgreSQL**: Primary data store\n- **External APIs**: Payment, email, integrations\n\n---\n\n### Level 3: Component\n**Shows**: Components within a container  \n**Audience**: Developers and architects  \n**Abstraction**: Medium-low  \n**Scope**: Major components and their responsibilities\n\n**Elements**:\n- Controllers/Handlers\n- Services\n- Repositories\n- Business Logic\n- Utilities\n\n**Example - UBOS API Components**:\n```\nExpress API\nâ”œâ”€â”€ Authentication Service\nâ”œâ”€â”€ CRM Module\nâ”‚   â”œâ”€â”€ Companies Controller\nâ”‚   â”œâ”€â”€ Contacts Service\nâ”‚   â””â”€â”€ Deal Repository\nâ”œâ”€â”€ Engagement Module\nâ””â”€â”€ Security Layer\n```\n\n---\n\n### Level 4: Code\n**Shows**: Classes, functions, interfaces  \n**Audience**: Developers  \n**Abstraction**: Low (detailed)  \n**Scope**: Implementation details\n\n**Elements**:\n- Classes\n- Functions\n- Interfaces\n- Methods\n- Properties\n\n**When to use**: Only when necessary - usually skip in favor of code itself\n\n---\n\n## ğŸ“ Notation\n\n### Symbols\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   Software      â”‚  = Software System\nâ”‚   System        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  App   â”‚         = Container (application, database, etc)\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”\nâ”‚Componentâ”‚  = Component (inside a container)\nâ””â”€â”€â”€â”€â”€â”€â”˜\n\nRole/Title       = Person/Actor\n(no box needed)\n\n  â”Œâ”€â”€â”€â”€â”€â”€â”\n  â”‚ Ext. â”‚       = External System\n  â”‚ API  â”‚\n  â””â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Lines and Labels\n\n```\nâ”Œâ”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”\nâ”‚ A  â”‚ â”€â”€â”€â”€â†’   â”‚ B  â”‚   = Interaction (label it: what's the interaction?)\nâ””â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”˜\n     Uses HTTPS/\n     JSON API\n```\n\n---\n\n## ğŸ¯ C4 in UBOS\n\n### Level 1: UBOS System Context\n\n**Users**:\n- Customers (business users)\n- Sales reps\n- Customer success team\n- Administrators\n\n**External Systems**:\n- Stripe (payments)\n- Sendgrid (email)\n- OAuth providers (authentication)\n- Third-party CRM integrations\n\n### Level 2: UBOS Containers\n\n**Frontend**:\n- React SPA (TypeScript)\n- Session management\n- State management (hooks)\n\n**Backend**:\n- Express.js API server\n- Authentication middleware\n- Business logic services\n\n**Data**:\n- PostgreSQL database\n- Drizzle ORM\n- Migrations\n\n**Infrastructure**:\n- Static file serving\n- Logging\n- Security utilities\n\n### Level 3: Key Components\n\n**Authentication Components**:\n- Session manager\n- CSRF protection\n- User validation\n- Token management\n\n**CRM Components**:\n- Companies service\n- Contacts controller\n- Deals repository\n- Engagement tracker\n\n**Security Components**:\n- Rate limiting\n- Input validation\n- CORS handling\n- Encryption utilities\n\n---\n\n## âœ… Quality Checklist\n\n### Context Diagram (Level 1)\n- [ ] Shows your system as a black box\n- [ ] Shows all user types\n- [ ] Shows all external systems\n- [ ] Clear labels on interactions\n- [ ] Can be understood by non-technical people\n\n### Container Diagram (Level 2)\n- [ ] Shows major applications\n- [ ] Shows databases\n- [ ] Shows external services\n- [ ] Technology stack is labeled\n- [ ] No internal details (save for Level 3)\n\n### Component Diagram (Level 3)\n- [ ] Shows major responsibilities\n- [ ] Groups related components\n- [ ] Clear interaction patterns\n- [ ] Technology choices are visible\n- [ ] Focused on one container\n\n### Code Diagram (Level 4)\n- [ ] Use sparingly\n- [ ] Only for complex logic\n- [ ] Generated from code when possible\n- [ ] Up-to-date (automated)\n\n---\n\n## ğŸ› ï¸ Tools for Drawing\n\n### Popular C4 Tools\n1. **Structurizr** (Official, best): structurizr.com\n2. **Draw.io**: Free, good for simple diagrams\n3. **Lucidchart**: Professional, collaborative\n4. **PlantUML**: Text-based, great for version control\n5. **Miro**: Collaborative whiteboard\n\n### For UBOS\nRecommendation: **Use Mermaid (text-based) or PlantUML for version control integration**\n\n```mermaid\ngraph TB\n    subgraph UBOS[\"UBOS Platform\"]\n        Web[\"React Web App\"]\n        API[\"Express API\"]\n        DB[\"PostgreSQL\"]\n    end\n    \n    User[\"User\"]\n    Stripe[\"Stripe\"]\n    \n    User -->|Uses| Web\n    Web -->|REST API| API\n    API -->|Queries| DB\n    API -->|Payment| Stripe\n```\n\n---\n\n## ğŸ“š Implementation Steps\n\n1. **Start with Level 1**: Draw your system context\n2. **Add Level 2**: Show major containers\n3. **Drill Into Level 3**: Pick important containers\n4. **Skip Level 4**: Unless absolutely necessary\n5. **Keep in Sync**: Update diagrams with architecture changes\n6. **Link from Code**: Reference in README files\n\n---\n\n## ğŸ”— Related Standards\n\n- **DiÃ¡taxis Framework**: Use C4 in your Explanation and How-To sections\n- **ISO 42010**: C4 aligns with architecture viewpoints\n- **ADR Pattern**: Reference C4 diagrams in architectural decisions\n\n---\n\n## ğŸ’¡ UBOS-Specific Guidance\n\n### Multi-Tenant Architecture\n\n**Level 2 Consideration**: Show tenant isolation explicitly\n```\nPostgreSQL Database\nâ”œâ”€â”€ Shared Schema (Users, Tenants)\nâ””â”€â”€ Tenant-specific Schemas\n    â”œâ”€â”€ Tenant 1\n    â”œâ”€â”€ Tenant 2\n    â””â”€â”€ Tenant 3\n```\n\n### Security Architecture\n\n**Level 3 Component Example**:\n```\nExpress API Server\nâ”œâ”€â”€ CSRF Protection Layer\nâ”œâ”€â”€ Session Management\nâ”œâ”€â”€ Authentication Service\nâ”œâ”€â”€ Rate Limiting\nâ””â”€â”€ Business Logic\n```\n\n---\n\n## ğŸ“– Examples\n\n### Example C4 Context Diagram\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   Customer User    â”‚â”€â”€â”€â”€â†’â”‚  UBOS Platform  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                    â”‚\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚               â”‚               â”‚\n              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”\n              â”‚  Stripe  â”‚     â”‚ SendGrid â”‚   â”‚ OAuth  â”‚\n              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Example C4 Container Diagram\n```\n     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n     â”‚         UBOS Platform                â”‚\n     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\n     â”‚  â”‚  React   â”‚  â”‚  Express API     â”‚ â”‚\n     â”‚  â”‚  SPA     â”‚  â”‚  (Node.js)       â”‚ â”‚\n     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\n     â”‚       â†‘                 â”‚            â”‚\n     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚\n     â”‚                                      â”‚\n     â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚\n     â”‚           â”‚ PostgreSQL   â”‚          â”‚\n     â”‚           â”‚ Database     â”‚          â”‚\n     â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚\n     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n**Last Updated**: 2026-02-04  \n**Review Cycle**: Quarterly\n"