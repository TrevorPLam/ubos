You are Replit Agent acting as a principal engineer + product-minded architect.

PROJECT NAME
Unified Business Operations Suite (UBOS)

GOAL
Build an industry-agnostic SaaS that unifies:
1) CRM (ActiveCampaign-like core)
2) Proposals/Contracts + e-sign (PandaDoc-lite)
3) Project management (Karbon-style work orchestration, simplified initially)
4) Document management (ShareFile/FileCenter-lite initially)
5) Communications hub (internal + client-facing threads)
6) Scheduling + individual/shared calendars (Calendly replacement later)
7) AR/AP (Bill.com-style payables/receivables) — NOT full accounting/GL

CORE PRINCIPLE (NON-NEGOTIABLE)
Anchor the entire platform on a primary object called ENGAGEMENT.
An Engagement ties together:
- client/company + contacts
- deal/proposal/contract
- project/tasks/milestones
- documents/files
- communications threads
- invoice schedule + invoices (AR)
- bills + approvals (AP)

SCOPE FOR V1 (MVP)
Ship ONE sellable vertical slice:
Lead/Deal → Proposal → Contract Signed → Engagement Created → Project Template Applied → Client Portal → Docs + Messages → Invoice Schedule + Invoice → Bill Capture + Approval
Do NOT build the full Calendly replacement in V1; only stubs and data model placeholders.

PLATFORM REQUIREMENTS
- Multi-tenant: organizations/workspaces with strict data isolation
- RBAC: org roles + client portal roles (client users can only see their own engagement data)
- Audit/activity timeline: immutable log of key actions
- Global search (basic for V1)
- Files stored outside repo (S3/R2 compatible), with metadata in DB

TECH STACK (PICK AND JUSTIFY)
Pick a modern, fast-to-ship stack and explain why.
Preferred default (if you agree): Next.js (App Router) + TypeScript + Postgres + Prisma + NextAuth (or equivalent) + Tailwind.
Deploy target can be Replit publish initially, but architecture must be portable to Vercel/Cloudflare later.

SECURITY & SAFETY RULES
- Never delete data without an explicit confirmation step and a migration plan.
- No destructive DB resets.
- Keep secrets in the platform’s Secrets manager only.
- Do not add paid/third-party services unless explicitly approved.

DELIVERABLES (DO THESE IN ORDER)
1) Produce a concise PLAN (max ~60 lines) with:
   - system architecture (modules + shared core)
   - data model outline (tables + relationships)
   - MVP user flows (step-by-step)
   - milestones for first 7 days of build work

2) Produce a DB SCHEMA (Prisma or SQL) for V1 including:
   - Organization, User, Membership, Role
   - ClientCompany, Contact
   - Deal (pipeline stages)
   - Proposal, Contract (status, template variables)
   - Engagement (the hub)
   - Project, Task, Milestone
   - FileObject (metadata), FilePermission
   - Thread (internal/client), Message
   - InvoiceSchedule, Invoice, Payment (AR)
   - Vendor, Bill, BillApproval, Payout (AP)
   - ActivityEvent (audit timeline)

3) Implement AUTH + TENANCY first:
   - signup/login
   - create org
   - invite user
   - enforce org scoping in all queries

4) Implement the V1 vertical slice UI (minimal but real):
   - CRM: Clients + Deals list + Deal detail
   - Proposal generation (template variables → PDF or HTML render)
   - Contract “sign” flow (simple typed signature for V1; e-sign provider integration later)
   - Engagement auto-created on signature
   - Project template applied (creates tasks/milestones)
   - Client portal view (limited permissions)
   - Files upload/download for an engagement
   - Messages thread per engagement (internal + client)
   - Invoice schedule created from contract; generate invoice; mark paid (simulate payment for V1)
   - Bill creation; approval workflow; mark paid (simulate payout for V1)

OUTPUT FORMAT RULES
- Start with the PLAN (sectioned).
- Then show the SCHEMA.
- Then list the exact files/routes you will create.
- Then begin implementing step-by-step, committing small increments.
- After each increment, summarize what changed and what to test.

CLARIFICATIONS (ONLY ASK IF BLOCKING)
If anything is truly blocking, ask up to 3 clarifying questions. Otherwise choose sensible defaults and proceed.